# План курсовой работы
## Тема: **Мультимодальные пучки на графах: объединение эмбеддингов для рекомендательных систем**

---

## 1. **ВВЕДЕНИЕ**

### 1.1. Актуальность задачи
- Контекст работы: проект в рамках сотрудничества с VK
- Проблема рекомендательных систем в экосистеме VK (VK Видео)
- Необходимость работы с мультимодальными данными (видео, текст, заголовки, речь)
- Важность построения репрезентативных мультимодальных эмбеддингов для качества рекомендаций
- Практическая значимость: возможность применения результатов в реальных продуктах VK

### 1.2. Постановка задачи
- **Цель работы:** реализация и исследование подхода к объединению мультимодальных эмбеддингов на основе пучков на графах для применения в рекомендательных системах
- **Задачи курсовой работы:**
  1. Изучение теоретических основ пучков на графах и их применения в машинном обучении
  2. Анализ статьи Neural Sheaf Diffusion и адаптация методов для задачи объединения эмбеддингов
  3. Реализация базового алгоритма обучения пучка на графе для одной модальности (первый этап работы)
  4. Расширение модели до мультимодального случая, где разные типы контента взаимодействуют через общие пучковые отображения (второй этап работы)
  5. Проведение экспериментов на открытых рекомендательных датасетах: подбор гиперпараметров, обучение модели и расчёт метрик (третий этап работы)
  6. Анализ результатов и сравнение с baseline-методами
  7. Подготовка рабочего прототипа модели, способного агрегировать мультимодальные эмбеддинги на графе с использованием пучковой структуры

### 1.3. Структура работы
- Краткое описание разделов курсовой работы

---

## 2. **ОБЗОР СТАТЬИ "NEURAL SHEAF DIFFUSION" И ОБОСНОВАНИЕ АКТУАЛЬНОСТИ**

### 2.1. Общая информация о статье
- **Название:** Neural Sheaf Diffusion
- **Авторы:** [указать авторов после изучения статьи]
- **Ссылка:** arxiv.org/pdf/2202.04579
- **Год публикации:** 2022
- **Основная область:** Графовые нейронные сети, топологическая теория данных

### 2.2. Основные концепции и теоретические основы статьи

#### 2.2.1. Пучки на графах (Sheaves on Graphs)
- Математическое определение пучка
- Структура пучка: векторные пространства на вершинах и рёбрах
- Линейные отображения между пространствами (restriction maps)
- Связь с алгебраической топологией

#### 2.2.2. Диффузия на пучках (Sheaf Diffusion)
- Процесс распространения информации через структуру пучка
- Механизм передачи признаков между вершинами через рёбра
- Математическая формализация процесса диффузии
- Связь с классическими графовыми нейронными сетями (GNN)

#### 2.2.3. Neural Sheaf Diffusion Model
- Архитектура нейронной сети для обучения пучков
- Процесс обучения отображений пучка
- Оптимизация параметров модели
- Отличия от стандартных GNN (Graph Convolutional Networks, Graph Attention Networks)

### 2.3. Ключевые результаты и вклад статьи
- Теоретические результаты
- Экспериментальные достижения
- Преимущества подхода по сравнению с классическими GNN
- Применимость к различным типам задач

### 2.4. Обоснование актуальности для данной работы

#### 2.4.1. Проблема объединения мультимодальных данных
- **Вызов:** Разные модальности (видео, текст, речь) имеют различную природу и представления
- **Традиционные подходы:** Простое конкатенирование или усреднение эмбеддингов теряет структуру данных
- **Необходимость:** Механизм, который учитывает семантические связи между модальностями

#### 2.4.2. Почему пучки на графах подходят для мультимодальных данных
- **Гибкость представления:** Каждая вершина может иметь своё векторное пространство, соответствующее типу модальности
- **Структурированная передача информации:** Линейные отображения на рёбрах позволяют контролируемо преобразовывать признаки между модальностями
- **Естественное моделирование взаимодействий:** Разные типы контента могут взаимодействовать через общие пучковые отображения

#### 2.4.3. Как Neural Sheaf Diffusion помогает решить задачу
- **Механизм диффузии:** Позволяет агрегировать информацию от соседних вершин с учётом структуры пучка
- **Обучение отображений:** Модель может научиться оптимальным способам преобразования признаков между модальностями
- **Масштабируемость:** Подход работает на графах произвольной структуры, что важно для рекомендательных систем

#### 2.4.4. Конкретные преимущества для рекомендательных систем
- **Сохранение семантики:** Пучковая структура сохраняет семантические отношения между элементами контента
- **Адаптивность:** Модель может адаптироваться к различным типам взаимодействий между модальностями
- **Интерпретируемость:** Линейные отображения пучка могут быть интерпретированы как преобразования между модальностями

### 2.5. Связь с задачей курсовой работы
- Как методы из статьи будут использованы в реализации
- Какие компоненты статьи будут адаптированы для мультимодального случая
- Ожидаемые улучшения по сравнению с простыми методами агрегации

---

## 3. **ТЕОРЕТИЧЕСКИЕ ОСНОВЫ**

### 3.1. Графы и графовые нейронные сети
- Основные определения (граф, вершина, ребро, смежность)
- Классические GNN: GCN, GAT, GraphSAGE
- Механизмы агрегации и обновления признаков

### 3.2. Пучки на графах: математический аппарат
- Определение пучка (sheaf)
- Структура пучка на графе: $\mathcal{F}(v)$, $\mathcal{F}(e)$, restriction maps
- Когомологии пучков
- Связь с алгебраической топологией

### 3.3. Мультимодальные эмбеддинги
- Понятие эмбеддинга
- Методы получения эмбеддингов для разных модальностей
- Проблемы объединения мультимодальных представлений
- Существующие подходы (early fusion, late fusion, cross-modal attention)

### 3.4. Рекомендательные системы
- Основные задачи рекомендательных систем
- Content-based и collaborative filtering подходы
- Метрики качества рекомендаций (Recall@K, NDCG, MRR)

---

## 4. **МЕТОДЫ И РЕАЛИЗАЦИЯ**

### 4.1. Архитектура модели
- Структура графа для рекомендательной системы
- Определение пучка для мультимодальных данных
- Инициализация векторных пространств для вершин и рёбер

### 4.2. Алгоритм обучения пучка для одной модальности (Этап 1)
- Базовый алгоритм диффузии на пучке
- Процесс передачи сообщений через рёбра
- Агрегация признаков в вершинах
- Обучение параметров отображений
- Получение практического опыта работы с концепцией пучков

### 4.3. Расширение до мультимодального случая (Этап 2)
- Моделирование взаимодействий между модальностями
- Общие пучковые отображения для разных типов контента (видео, текст, заголовки, речь)
- Механизм объединения мультимодальных эмбеддингов
- Адаптация структуры пучка для работы с несколькими модальностями одновременно

### 4.4. Технические детали реализации
- Выбор фреймворка (PyTorch Geometric, DGL)
- Структура данных для представления пучка
- Оптимизация вычислений
- Обработка данных

---

## 5. **ЭКСПЕРИМЕНТАЛЬНАЯ ЧАСТЬ**

### 5.1. Описание датасетов
- Выбранные открытые рекомендательные датасеты
- Характеристики датасетов (размер, модальности, структура)
- Предобработка данных

### 5.2. Экспериментальная установка (Этап 3)
- Окружение и инструменты (Python, PyTorch/PyTorch Geometric)
- Подбор гиперпараметров модели
- Процесс обучения (оптимизатор, функция потерь, валидация)
- Метрики качества для оценки результатов

### 5.3. Baseline-методы для сравнения
- Простые методы агрегации (конкатенация, усреднение)
- Классические GNN (GCN, GAT)
- Другие методы объединения мультимодальных эмбеддингов

### 5.4. Результаты экспериментов
- Метрики качества на тестовых данных
- Сравнение с baseline-методами
- Анализ влияния гиперпараметров
- Визуализация результатов
- Таблицы с метриками и гиперпараметрами (для приложения к отчёту)

### 5.5. Обсуждение результатов
- Интерпретация полученных результатов
- Преимущества и недостатки подхода
- Возможные улучшения

---

## 6. **ЗАКЛЮЧЕНИЕ**

### 6.1. Итоги работы
- Достигнутые результаты
- Выполненные задачи

### 6.2. Выводы
- Основные выводы из проведённого исследования
- Практическая значимость работы

### 6.3. Направления дальнейших исследований
- Расширение до дипломной работы (углубление мультимодального подхода)
- Возможные улучшения модели
- Применение к другим задачам
- Интеграция в реальные продукты VK

---

## **СПИСОК ЛИТЕРАТУРЫ**

- Статья Neural Sheaf Diffusion (arxiv.org/pdf/2202.04579)
- Классические работы по графовым нейронным сетям
- Работы по мультимодальному обучению
- Материалы по рекомендательным системам

---

## **ПРИЛОЖЕНИЯ**

### Приложение А. Исходный код
- Структура проекта
- Основные модули

### Приложение Б. Таблицы с метриками и гиперпараметрами
- Детальные результаты экспериментов
- Сравнительные таблицы
- Формат: таблицы с метриками и гиперпараметрами (требование к результату проекта)

### Приложение В. Примеры использования
- Инструкция по запуску
- Примеры работы с моделью